\documentclass[a4paper,final,notitlepage,11pt,svgnames]{scrartcl}
\input{../../diary/preambule}
\usepackage[hmargin=1cm,vmargin=.5cm]{geometry}
\begin{document}
\begin{table}[htpb]
	\centering
	\caption{\textsc{Slashdot} ($82052$ nodes) \label{tab:slash}}
	\begin{tabular}{lllllll}
		\toprule
		& edges          & accuracy    & $F_1$       & Matthews    & path-stretch & test edge-stretch \\
		\midrule
		BFS            & 82051, 16.5\%  & .619 (.06)  & .720 (.06)  & .145 (.08)  & 1.362 (.036) & 4.007 (.122)\\
		AsymExp $z=15$ & 36.3\%         & .740 (.001) & .830 (.001) & .282 (.004) & ---          & --- \\
		$k=0$          & 180863, 36.3\% & .699        & .797        & .216        & 1.288        & 3.559 \\
		$k=1$          & 82058, 16.5\%  & .683        & .782        & .199        & 1.826        & 5.967 \\
		$k=2$          &                &             &             &             &              & \\
		$k=3$          & 82051, 16.5\%  & .654 (.032) & .757 (.029) & .167 (.036) & 1.826        & 5.967 \\
		AsymExp $z=15$ & 16.5\%         & .691 (.002) & .790 (.002) & .218 (.005) & ---          & --- \\
		\bottomrule
	\end{tabular}
\end{table}
% 0 80  1.34248466116 3.94492906039
% 1 47  1.3413958948  3.93894079202
% 2 636 1.31810350793 3.85968387513
% 3 191 1.41901184333 4.19879176711
% 4 41  1.389387887   4.0916811533
% 0.682531526426 0.782438854224 0.199444522133
% 3 3 1.82554985847 5.96880732623
% 0.682530992703 0.782437849259 0.199446514659
% 1 1 1.82545458657 5.96863391993
% time python gtx_tree_stretch.py 0
% 0.699251410295 0.797430161675 0.215772802986
% 0 0 1.28821346702 3.55943386723

% time python spectral_prediction.py 
% 15 5
% (0.58257908282293425, 0.69047831511843993, 0.090797322147076684)
% 15 7.5
% (0.62702074263986585, 0.73246943985910518, 0.14230653798144915)
% 15 11
% (0.65964606040923845, 0.76191933565341396, 0.18036535884648414)
% 15 16.5
% (0.68918292387040359, 0.78851723754666525, 0.2081298429811583)
% 15 36.3
% (0.7403421676904467, 0.82992315259581217, 0.28130498893720662)
% 15 50
% (0.75615024793720265, 0.84236100295904048, 0.30498460465495042)
% time python spectral_prediction.py 
% 15 16.5
% ^[(0.69506836348085554, 0.79188816050528477, 0.22831166672551437)
% 15 36.1
% (0.7411537327200507, 0.83061356898236738, 0.28204718864598172)
% 15 16.5
% (0.68638473526607868, 0.78539091911468695, 0.21078346371106391)
% 15 36.1
% (0.7411495883565965, 0.830015541200671, 0.28764534661803887)
% 15 16.5
% (0.69231858390089607, 0.79031253015476866, 0.21906416174497589)
% 15 36.1
% (0.74111313186519789, 0.8302088912694161, 0.28550793952775311)
% 15 16.5
% (0.69132744383392475, 0.78927375254640952, 0.21936578545105237)
% 15 36.1
% (0.73904294293634376, 0.82921146548376568, 0.27639259255017257)
% 15 16.5
% (0.69062137503212184, 0.78906794952826009, 0.21534351472603996)
% 15 36.1
% (0.73861566770992249, 0.82864271868684769, 0.27794558992573098)
% 15 16.5
% (0.69071761465819237, 0.78987695284143833, 0.20964606156866164)
% 15 36.1
% (0.74037300669047734, 0.8298742876920604, 0.28203776027347333)
% 15 16.5
% (0.68984585094122164, 0.78868543702344074, 0.21238294023329848)
% 15 36.1
% (0.7397644825027978, 0.82965304228476422, 0.27868179938570181)
% 15 16.5
% (0.69238284766415492, 0.79043022763288928, 0.21875301730022823)
% 15 36.1
% (0.74097165076353855, 0.83050223918480937, 0.28146797293668685)
% 15 16.5
% (0.6934166520402103, 0.79103998217042326, 0.2220801869536736)
% 15 36.1
% (0.74133058128628926, 0.8302321846936801, 0.28724963385241536)
% 15 16.5
% (0.6925079993465999, 0.79022959309090313, 0.22141122373212338)
% 15 36.1
% (0.74038181082581411, 0.83020214762622691, 0.27901964294775194)
\begin{table}[htpb]
	\centering
	\caption{\textsc{Epinion} ($119070$ nodes) \label{tab:epinion}}
	\begin{tabular}{lllllll}
		\toprule
						& edges          & accuracy    & $F_1$       & Matthews    & path-stretch & test edge-stretch \\
		 \midrule
		 BFS            & 119069, 17.0\% & .706 (0.10) & .803 (0.08) & .240 (0.13) & 1.310 (.033) & 3.594 (.011)\\
		 AsymExp $z=15$ & 27.1\%         & .826        & .893        & .433        & ---          & --- \\
		 $k=0$          & 190274, 27.1\% & .706        & .809        & .215        & 1.333        & 3.298\\
		 $k=1$          & 119071         & .651        & .764        & .161        &              & \\
		 $k=2$          & 119069         & .651        & .764        & .161        &              & \\
		 $k=3$          & 119069, 17.0\% & .651        & .764        & .161        & 1.686        & 4.861\\
		 AsymExp $z=15$ & 17.0\%         & .806        & .880        & .389        & ---          & --- \\
		\bottomrule
	\end{tabular}
\end{table}
% time python gtx_tree_stretch.py 0
% 0.706232214279 0.809418314884 0.215570303366
% Active set size 190274
% 0 0 1.33321136916 3.29844610254
% time python gtx_tree_stretch.py 3
% Active set size 119069
% 3 3 1.68577008016 4.86112961373
% time python gtx_tree_stretch.py 3
% 0.651222317597 0.764365916374 0.160948939455
% Active set size 119069
% time python gtx_tree_stretch.py 2
% 0.651222317597 0.764365916374 0.160948939455
% Active set size 119069
% time python gtx_tree_stretch.py 1
% 0.651221120073 0.764364823189 0.160948026837
% Active set size 119071
% time python bfs_tree_stretch.py 0
% 0 25 1.25311157385 3.41369613734
% real    45m24.898s
% time python bfs_tree_stretch.py 1
% 1 1652 1.32416257802 3.59375793991
% real    45m9.892s
% time python bfs_tree_stretch.py 2
% 2 12168 1.33136148043 3.68492017167
% time python bfs_tree_stretch.py 3
% 3 68213 1.33266134993 3.68479828326
% real    45m41.246s

% time python spectral_prediction.py 
% 15 5
% (0.7297330151726622, 0.82535104452657604, 0.25698181944241877)
% (0.72678118002989389, 0.82321789056969819, 0.25172484596486777)
% 15 7.5
% (0.76117810117810114, 0.84886280907647649, 0.29703859210759531)
% (0.76071031878690587, 0.84832280826472584, 0.2997591399363243)
% 15 11
% (0.78253175382319073, 0.86332461686807138, 0.34572507002717195)
% (0.78627842847122809, 0.86624862576653916, 0.34665070795548575)
% 15 17
% (0.8068044744574463, 0.88028926314982525, 0.38767099546852168)
% (0.80605311496798338, 0.87957293674210779, 0.39005958445307459)
% 15 27.1
% (0.82563125763125766, 0.89274001756922228, 0.43190474070150242)
% (0.82682780377990273, 0.89348545801012458, 0.43536402918462946)
% 15 50
% (0.84763903283486897, 0.90724051317520649, 0.48277811613279248)
% (0.84676818989540581, 0.90672097901126525, 0.47944417345913931)


Matthews Correlation Coefficient \[
	\text{MCC} = \frac{ TP \times TN - FP \times FN } {\sqrt{ (TP + FP) ( TP + FN ) (
			TN + FP ) ( TN + FN ) } } = \pm \sqrt{\frac{\chi^2}{n}}
\]
Predicting all edges but one to be positive on Slashdot gives $.764$ accuracy,
$.886$ $F_1$ score but $-0.0007$ MCC.

\begin{table}[htpb]
	\centering
	\caption{\textsc{Wikipedia} ($7065$ nodes) \label{tab:wiki}}
	\begin{tabular}{lllllll}
		\toprule
		         & edges         & accuracy      & $F_1$         & Matthews      & path-stretch & test edge-stretch \\
		\midrule
		BFS      & 7064, 7.1\%   & 0.662 (0.067) & 0.764 (0.059) & 0.185 (0.081) &              & \\
		AsymExp $z=15$ & 10.8\%  & 0.771 (0.004) & 0.855 (0.003) & 0.312 (0.008) & ---          & --- \\
		$k=1$    & 10839, 10.8\% & 0.671 (0.029) & 0.777 (0.025) & 0.173 (0.032) &              & \\
		$k=2$    & \%            &               &               &               &              & \\
		$k=3$    & 7064, 7.1\%   & 0.654 (0.041) & 0.761 (0.035) & 0.157 (0.047) &              & \\
		AsymExp $z=15$ & 7.1\%   & 0.737 (0.006) & 0.829 (0.005) & 0.256 (0.007) & ---          & --- \\
		\bottomrule
	\end{tabular}
\end{table}

While on average, $k=1$ give better results with a smaller variance, for
individual labeling, the situation is rather surprising since in 24\% of the
cases, $k=3$ is actually better, as showed in Figures~\ref{fig:mcc0} and
\ref{fig:violin}.

\begin{figure}[htpb]
	\centering
	\includegraphics[width=1.0\linewidth]{wiki_mcc0.png}
	\caption{All points should be below the diagonal \label{fig:mcc0}}
\end{figure}

\begin{figure}[htpb]
	\centering
	\includegraphics[width=1.0\linewidth]{wiki_mcc_violin.png}
	\caption{Yet there is some mixing \label{fig:violin}}
\end{figure}

\begin{table}[htpb]
	\centering
	\vspace*{-2em}
	\caption{\textsc{2 synthetic clusters} ($1000$ nodes, 5731 positive edges, 1686 negative ones) \label{tab:synth}}
	\begin{tabular}{llllllll}
		\toprule
		noise                     & method         & edges        & accuracy      & $F_1$         & Matthews       & path-stretch  & test edge-stretch \\
		\midrule
		\multirow{6}{*}{0}        & BFS            & 999, 13.5\%  & 1.000 (0.000) & 1.000 (0.000) & 1.000 (0.000)  & 2.004 (0.023) & 5.597 (0.068) \\
		& AsymExp $z=15$ & 56.3\%       & 1.000 (0.000) & 1.000 (0.000) & 1.000 (0.000)  & ---           & ---\\
		& $k=0$          & 4174, 56.3\% & 1.000         & 1.000         & 1.000          & 1.243         & 3.497 \\
		& $k=1$          & 1012, 13.6\% & 1.000         & 1.000         & 1.000          & 2.638         & 7.303 \\
		& $k=2$          & 999, 13.5\%  & 1.000         & 1.000         & 1.000          & 2.678         & 7.417 \\
		& AsymExp $z=15$ & 13.5\%       & 0.596 (0.021) & 0.697 (0.018) & 0.154 (0.039)  & ---           & ---\\
		\midrule
		\multirow{6}{*}{0.02}     & BFS            &              & 0.872 (0.070) & 0.912 (0.052) & 0.681 (0.147)  &               & \\
		& AsymExp $z=15$ & 56.3\%       & 0.980 (0.002) & 0.987 (0.001) & 0.944 (0.006)  &               & \\
		& $k=0$          &              & 0.904 (0.015) & 0.938 (0.010) & 0.727 (0.038)  &               & \\
		& $k=1$          &              & 0.858 (0.072) & 0.901 (0.055) & 0.657 (0.147)  &               & \\
		& $k=2$          &              & 0.858 (0.072) & 0.901 (0.055) & 0.657 (0.147)  &               & \\
		& AsymExp $z=15$ & 13.5\%       & 0.569 (0.013) & 0.669 (0.012) & 0.111 (0.025)  &               & \\
		\cmidrule(r){2-6}
		\multirow{6}{*}{0.04}     & BFS            &              & 0.762 (0.063) & 0.830 (0.051) & 0.448 (0.117)  &               & \\
		& AsymExp $z=15$ & 56.3\%       & 0.960 (0.003) & 0.974 (0.002) & 0.890 (0.008)  &               & \\
		& $k=0$          &              & 0.824 (0.018) & 0.883 (0.013) & 0.541 (0.037)  &               & \\
		& $k=1$          &              & 0.746 (0.073) & 0.816 (0.059) & 0.427 (0.136)  &               & \\
		& $k=2$          &              & 0.746 (0.073) & 0.815 (0.059) & 0.427 (0.136)  &               & \\
		& AsymExp $z=15$ & 13.5\%       & 0.553 (0.005) & 0.653 (0.005) & 0.081 (0.010)  &               & \\
		\cmidrule(r){2-6}
		\multirow{6}{*}{0.07}     & BFS            &              & 0.664 (0.061) & 0.749 (0.053) & 0.265 (0.106)  &               & \\
		& AsymExp $z=15$ & 56.3\%       & 0.927 (0.004) & 0.952 (0.003) & 0.808 (0.013)  &               & \\
		& $k=0$          &              & 0.726 (0.018) & 0.808 (0.015) & 0.347 (0.034)  &               & \\
		& $k=1$          &              & 0.639 (0.056) & 0.725 (0.050) & 0.230 (0.096)  &               & \\
		& $k=2$          &              & 0.639 (0.056) & 0.724 (0.050) & 0.230 (0.096)  &               & \\
		& AsymExp $z=15$ & 13.5\%       & 0.542 (0.013) & 0.640 (0.012) & 0.061 (0.021)  &               & \\
		\cmidrule(r){2-6}
		\multirow{6}{*}{0.1}      & BFS            &              & 0.614 (0.053) & 0.702 (0.049) & 0.179 (0.087)  &               & \\
		& AsymExp $z=15$ & 56.3\%       & 0.862 (0.007) & 0.906 (0.005) & 0.648 (0.016)  &               & \\
		& $k=0$          &              & 0.655 (0.014) & 0.748 (0.012) & 0.225 (0.024)  &               & \\
		& $k=1$          &              & 0.582 (0.038) & 0.670 (0.036) & 0.130 (0.063)  &               & \\
		& $k=2$          &              & 0.582 (0.038) & 0.670 (0.036) & 0.130 (0.063)  &               & \\
		& AsymExp $z=15$ & 13.5\%       & 0.517 (0.007) & 0.607 (0.006) & 0.026 (0.017)  &               & \\
		\cmidrule(r){2-6}
		\multirow{6}{*}{0.15}     & BFS            &              & 0.552 (0.032) & 0.635 (0.033) & 0.077 (0.049)  &               & \\
		& AsymExp $z=15$ & 56.3\%       & 0.749 (0.005) & 0.820 (0.005) & 0.406 (0.011)  &               & \\
		& $k=0$          &              & 0.581 (0.011) & 0.675 (0.011) & 0.109 (0.020)  &               & \\
		& $k=1$          &              & 0.527 (0.017) & 0.609 (0.018) & 0.042 (0.026)  &               & \\
		& $k=2$          &              & 0.527 (0.017) & 0.609 (0.018) & 0.042 (0.026)  &               & \\
		& AsymExp $z=15$ & 13.5\%       & 0.507 (0.009) & 0.590 (0.010) & 0.009 (0.013)  &               & \\
		\cmidrule(r){2-6}
		\multirow{6}{*}{0.2}      & BFS            &              & 0.521 (0.019) & 0.596 (0.021) & 0.029 (0.029)  &               & \\
		& AsymExp $z=15$ & 56.3\%       & 0.652 (0.008) & 0.734 (0.008) & 0.234 (0.018)  &               & \\
		& $k=0$          &              & 0.537 (0.013) & 0.622 (0.014) & 0.047 (0.021)  &               & \\
		& $k=1$          &              & 0.510 (0.011) & 0.582 (0.012) & 0.015 (0.019)  &               & \\
		& $k=2$          &              & 0.510 (0.011) & 0.582 (0.012) & 0.015 (0.019)  &               & \\
		& AsymExp $z=15$ & 13.5\%       & 0.499 (0.005) & 0.569 (0.006) & -0.004 (0.010) &               & \\
		\cmidrule(r){2-6}
		\multirow{6}{*}{0.3}      & BFS            &              & 0.503 (0.005) & 0.551 (0.006) & 0.006 (0.010)  &               & \\
		& AsymExp $z=15$ & 56.3\%       & 0.530 (0.007) & 0.589 (0.008) & 0.045 (0.014)  &               & \\
		& $k=0$          &              & 0.504 (0.010) & 0.562 (0.010) & 0.004 (0.019)  &               & \\
		& $k=1$          &              & 0.499 (0.006) & 0.548 (0.007) & -0.001 (0.012) &               & \\
		& $k=2$          &              & 0.499 (0.006) & 0.548 (0.007) & -0.002 (0.012) &               & \\
		& AsymExp $z=15$ & 13.5\%       & 0.499 (0.008) & 0.548 (0.009) & -0.001 (0.015) &               & \\
		\cmidrule(r){2-6}
		\multirow{6}{*}{0.4}      & BFS            &              & 0.499 (0.006) & 0.529 (0.007) & -0.001 (0.013) &               & \\
		& AsymExp $z=15$ & 56.3\%       & 0.497 (0.004) & 0.520 (0.007) & -0.007 (0.007) &               & \\
		& $k=0$          &              & 0.498 (0.009) & 0.528 (0.009) & -0.004 (0.019) &               & \\
		& $k=1$          &              & 0.499 (0.006) & 0.524 (0.006) & -0.002 (0.011) &               & \\
		& $k=2$          &              & 0.499 (0.006) & 0.524 (0.007) & -0.002 (0.011) &               & \\
		& AsymExp $z=15$ & 13.5\%       & 0.500 (0.007) & 0.526 (0.009) & 0.000 (0.014)  &               & \\
		\bottomrule
	\end{tabular}
\end{table}

\begin{figure}[htpb]
	\centering
	\includegraphics[width=1.0\linewidth]{mcc.png}
	\caption{Matthews Correlation Coefficient as noise increase (above 0 means better than random).
	\label{fig:mcc}}
\end{figure}
\end{document}
